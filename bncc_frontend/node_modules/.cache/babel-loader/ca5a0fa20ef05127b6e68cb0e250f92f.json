{"ast":null,"code":"import _slicedToArray from \"/Users/ns/Code/bncc_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/ns/Code/bncc_frontend/src/hoc/withErrorHandler/withErrorHandler.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { modal } from \"../../helpers/utility\";\n\nfunction withErrorHandler(WrappedComponent, axios) {\n  return props => {\n    const _useState = useState(null),\n          _useState2 = _slicedToArray(_useState, 2),\n          error = _useState2[0],\n          setError = _useState2[1];\n\n    const reqInterceptors = axios.interceptors.request.use(req => {\n      setError(null);\n      return req;\n    });\n    const resInterceptors = axios.interceptors.response.use(res => res, err => {\n      setError(err.response.data.error);\n      return Promise.reject(err);\n    });\n    useEffect(() => {\n      return () => {\n        axios.interceptors.request.eject(reqInterceptors);\n        axios.interceptors.response.eject(resInterceptors);\n      };\n    }, [resInterceptors, reqInterceptors]);\n    useEffect(() => {\n      if (error) {\n        modal(\"error\", \"Something went wrong (\".concat(error.status, \")\"), error.message, () => {\n          setError(null);\n        });\n      }\n    }, [error]);\n    return React.createElement(React.Fragment, null, React.createElement(WrappedComponent, Object.assign({}, props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    })));\n  };\n}\n\nexport default withErrorHandler;","map":{"version":3,"sources":["/Users/ns/Code/bncc_frontend/src/hoc/withErrorHandler/withErrorHandler.js"],"names":["React","useState","useEffect","modal","withErrorHandler","WrappedComponent","axios","props","error","setError","reqInterceptors","interceptors","request","use","req","resInterceptors","response","res","err","data","Promise","reject","eject","status","message"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,KAAT,QAAsB,uBAAtB;;AAEA,SAASC,gBAAT,CAA0BC,gBAA1B,EAA4CC,KAA5C,EAAmD;AAC/C,SAAOC,KAAK,IAAI;AAAA,sBACcN,QAAQ,CAAC,IAAD,CADtB;AAAA;AAAA,UACLO,KADK;AAAA,UACEC,QADF;;AAGZ,UAAMC,eAAe,GAAGJ,KAAK,CAACK,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+BC,GAAG,IAAI;AAC1DL,MAAAA,QAAQ,CAAC,IAAD,CAAR;AACA,aAAOK,GAAP;AACH,KAHuB,CAAxB;AAKA,UAAMC,eAAe,GAAGT,KAAK,CAACK,YAAN,CAAmBK,QAAnB,CAA4BH,GAA5B,CACpBI,GAAG,IAAIA,GADa,EAEpBC,GAAG,IAAI;AACHT,MAAAA,QAAQ,CAACS,GAAG,CAACF,QAAJ,CAAaG,IAAb,CAAkBX,KAAnB,CAAR;AACA,aAAOY,OAAO,CAACC,MAAR,CAAeH,GAAf,CAAP;AACH,KALmB,CAAxB;AAQAhB,IAAAA,SAAS,CAAC,MAAM;AACZ,aAAO,MAAM;AACTI,QAAAA,KAAK,CAACK,YAAN,CAAmBC,OAAnB,CAA2BU,KAA3B,CAAiCZ,eAAjC;AACAJ,QAAAA,KAAK,CAACK,YAAN,CAAmBK,QAAnB,CAA4BM,KAA5B,CAAkCP,eAAlC;AACH,OAHD;AAIH,KALQ,EAKN,CAACA,eAAD,EAAkBL,eAAlB,CALM,CAAT;AAOAR,IAAAA,SAAS,CAAC,MAAM;AACZ,UAAIM,KAAJ,EAAW;AACPL,QAAAA,KAAK,CACD,OADC,kCAEwBK,KAAK,CAACe,MAF9B,QAGDf,KAAK,CAACgB,OAHL,EAID,MAAM;AACFf,UAAAA,QAAQ,CAAC,IAAD,CAAR;AACH,SANA,CAAL;AAQH;AACJ,KAXQ,EAWN,CAACD,KAAD,CAXM,CAAT;AAaA,WACI,0CACI,oBAAC,gBAAD,oBAAsBD,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADJ,CADJ;AAKH,GAzCD;AA0CH;;AAED,eAAeH,gBAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { modal } from \"../../helpers/utility\";\n\nfunction withErrorHandler(WrappedComponent, axios) {\n    return props => {\n        const [error, setError] = useState(null);\n\n        const reqInterceptors = axios.interceptors.request.use(req => {\n            setError(null);\n            return req;\n        });\n\n        const resInterceptors = axios.interceptors.response.use(\n            res => res,\n            err => {\n                setError(err.response.data.error);\n                return Promise.reject(err);\n            }\n        );\n\n        useEffect(() => {\n            return () => {\n                axios.interceptors.request.eject(reqInterceptors);\n                axios.interceptors.response.eject(resInterceptors);\n            };\n        }, [resInterceptors, reqInterceptors]);\n\n        useEffect(() => {\n            if (error) {\n                modal(\n                    \"error\",\n                    `Something went wrong (${error.status})`,\n                    error.message,\n                    () => {\n                        setError(null);\n                    }\n                );\n            }\n        }, [error]);\n\n        return (\n            <>\n                <WrappedComponent {...props} />\n            </>\n        );\n    };\n}\n\nexport default withErrorHandler;\n"]},"metadata":{},"sourceType":"module"}