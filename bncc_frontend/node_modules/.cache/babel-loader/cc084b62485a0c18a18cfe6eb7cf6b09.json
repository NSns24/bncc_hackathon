{"ast":null,"code":"import { put } from \"redux-saga/effects\";\nimport axios from \"../../axios\";\nimport * as actions from \"../actions/index\";\nexport function* loginSaga(action) {\n  try {\n    const data = {\n      email: action.email,\n      password: action.password\n    };\n    const res = yield axios.post(\"/user/login\", data);\n\n    if (res.data.success) {\n      yield localStorage.setItem(\"user\", res.data.user.email);\n      yield put(actions.loginSuccess(res.data.user));\n\n      if (res.data.user.venueId) {\n        yield put(actions.setVenueID(res.data.user.venueId));\n      }\n    } else {\n      yield put(actions.loginFail(res.data.message));\n    }\n  } catch (err) {\n    console.log(err);\n  }\n}\nexport function* registerSaga(action) {\n  try {\n    const data = {\n      user: {\n        email: action.email,\n        password: action.password,\n        name: action.name,\n        phone: action.phone,\n        role: action.role\n      }\n    };\n    const res = yield axios.post(\"/user/upsert\", data);\n\n    if (res.data.success) {\n      yield localStorage.setItem(\"user\", res.data.user.email);\n      yield put(actions.registerSuccess(res.data.user));\n    }\n  } catch (err) {\n    console.log(err);\n  }\n}\nexport function* getUserSaga(action) {\n  try {\n    const data = {\n      email: localStorage.getItem(\"user\")\n    };\n    const res = yield axios.post(\"/user/get/email\", data);\n\n    if (res.data.success) {\n      yield put(actions.loginSuccess(res.data.user));\n\n      if (res.data.user.venueId) {\n        yield put(actions.setVenueID(res.data.user.venueId));\n      }\n    }\n  } catch (err) {\n    console.log(err);\n  }\n}\nexport function* logoutSaga(action) {\n  yield localStorage.removeItem(\"user\");\n  yield put(actions.logoutSuccess());\n}","map":{"version":3,"sources":["/Users/ns/Code/bncc_frontend/src/store/sagas/auth.js"],"names":["put","axios","actions","loginSaga","action","data","email","password","res","post","success","localStorage","setItem","user","loginSuccess","venueId","setVenueID","loginFail","message","err","console","log","registerSaga","name","phone","role","registerSuccess","getUserSaga","getItem","logoutSaga","removeItem","logoutSuccess"],"mappings":"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","sourcesContent":["import { put } from \"redux-saga/effects\";\nimport axios from \"../../axios\";\nimport * as actions from \"../actions/index\";\n\nexport function* loginSaga(action) {\n    try {\n        const data = {\n            email: action.email,\n            password: action.password\n        };\n\n        const res = yield axios.post(\"/user/login\", data);\n\n        if (res.data.success) {\n            yield localStorage.setItem(\"user\", res.data.user.email);\n            yield put(actions.loginSuccess(res.data.user));\n            \n            if (res.data.user.venueId) {\n                yield put(actions.setVenueID(res.data.user.venueId));\n            }\n        } else {\n            yield put(actions.loginFail(res.data.message));\n        }\n    } catch (err) {\n        console.log(err);\n    }\n}\n\nexport function* registerSaga(action) {\n    try {\n        const data = {\n            user: {\n                email: action.email,\n                password: action.password,\n                name: action.name,\n                phone: action.phone,\n                role: action.role\n            }\n        };\n\n        const res = yield axios.post(\"/user/upsert\", data);\n\n        if (res.data.success) {\n            yield localStorage.setItem(\"user\", res.data.user.email);\n            yield put(actions.registerSuccess(res.data.user));\n        }\n    } catch (err) {\n        console.log(err);\n    }\n}\n\nexport function* getUserSaga(action) {\n    try {\n        const data = {\n            email: localStorage.getItem(\"user\")\n        };\n\n        const res = yield axios.post(\"/user/get/email\", data);\n\n        if (res.data.success) {\n            yield put(actions.loginSuccess(res.data.user));\n\n            if (res.data.user.venueId) {\n                yield put(actions.setVenueID(res.data.user.venueId));\n            }\n        }\n    } catch (err) {\n        console.log(err);\n    }\n}\n\nexport function* logoutSaga(action) {\n    yield localStorage.removeItem(\"user\");\n    yield put(actions.logoutSuccess());\n}\n"]},"metadata":{},"sourceType":"module"}